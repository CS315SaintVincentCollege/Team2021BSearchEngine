<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Search</title>
    <script type="text/javascript">
        function validate(thisform) {
            if ((thisform.Key1.value == "") && (thisform.Key2.value == "") && (thisform.Key3.value == "")) {
                alert("No keywords or phrases entered.  Please try again.")
                thisform.Key1.focus()
                return false
            }
            else
            {
                return true
            }
        }

        function getJsonResults() {
            let formElement = document.getElementById('SearchForm');
            let formData = new FormData(formElement);
            let searchTerm = formData.get('searchkey');
            return new Promise(async (resolve, reject)=>{
                let results = await fetch(`http://localhost:8080/api/search/?Search=${searchTerm}`);
                if (results != []) {
                    resolve(await results.json());
                } else {
                    reject({"errorCode": -1, "Message": "no valid results from search term"});
                }
            }) 
        }

        async function fillOutSearchResults() {
            let data = await getJsonResults();
            console.log(data);
            // for each loop here with data
        }
    </script>
</head>

<body>

    <h2>Search the CIS Department Web Pages</h2>

    <form id="SearchForm"> <!--  method="GET" action="http://localhost:8080/api/search"> -->

        <input type="text" id="searchkey" name="searchkey" size="36" maxlength="48" />
        <strong>Keyword or phrase</strong>

        <p>
            <button type="button" onclick="fillOutSearchResults()">Submit</button>
            <input type="reset" value="Clear the form" />
        </p>
    </form>

</body>

</html>